<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.7/p5.js"></script>
<script src="lsystem.js"></script>
<script>

  var angle = 20;
  var d = 40;
  var iter = 7;

  var w = 1920;
  var h = 1080;
  var x = w * .3;
  var y = h * .8;
  var r = -135;

  var cInc = 0.01;

  var c;
  var system = new LSystem({
    axiom: 'f',
    rules: {
      'f': ">f*[f-f-f-f]"
    },
    renderRules: {
      'f': function () {
        stroke(c);
        noFill();
        strokeWeight(0.5)
        line(0, 0, d, 0);
        translate(d,0);
      },
      '<': function () {
        c = color((c.hsba[0] - cInc) % 360, c.hsba[1], c.hsba[2], c.hsba[3]);
      },
      '>': function () {
        c = color((c.hsba[0] + cInc) % 360, c.hsba[1], c.hsba[2], c.hsba[3]);
      },
      '[': function () {
        push();
      },
      ']': function () {
        pop();
      },
      '*': function () {
        rotate(random(10));
      },
      '+': function () {
        rotate(angle);
      },
      '-': function () {
        rotate(-1 * angle);
      }
    }
  });

  function setup() {
    angleMode(DEGREES);
    colorMode(HSB);
    c = color(180, 80, 50, 0.1);

    frameRate(1);
    createCanvas(w, h);
    background(10);
    /* translate(0, 1024 / 2); */
    translate(x, y);
    rotate(r);
    push();
    system.reset();
    system.simulate(iter);
    system.render();
    pop();
  }


</script>

