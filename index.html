<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.7/p5.js"></script>
<script src="lsystem.js"></script>
<script>

  var angle = 30.9;
  var d = 80;
  var iter = 7;

  var w = 1920;
  var h = 1080;
  var x = 2 * w/3;
  var y = h/2;
  var r = -135;

  var cInc = 0.01;

  var c;
  var system = new LSystem({
    axiom: 'f',
    rules: {
      'f': "f[f-f-f-f]"
    },
    renderRules: {
      'f': function () {
        stroke(c);
        noFill();
        strokeWeight(0.5)
        line(0, 0, d, 0);
        translate(d,0);
      },
      '<': function () {
        c = color((c.hsba[0] - cInc) % 360, c.hsba[1], c.hsba[2], c.hsba[3]);
      },
      '>': function () {
        c = color((c.hsba[0] + cInc) % 360, c.hsba[1], c.hsba[2], c.hsba[3]);
      },
      '[': function () {
        push();
      },
      ']': function () {
        pop();
      },
      '+': function () {
        rotate(angle);
      },
      '-': function () {
        rotate(-1 * angle);
      }
    }
  });

  function setup() {
    angleMode(DEGREES);
    colorMode(HSB);
    c = color(0, 0, 0, 0.1);
    console.log(c);

    frameRate(1);
    createCanvas(w, h);
    background(255);
    /* translate(0, 1024 / 2); */
    translate(x, y);
    rotate(r);
    push();
    system.reset();
    system.simulate(iter);
    system.render();
    pop();
  }


</script>

